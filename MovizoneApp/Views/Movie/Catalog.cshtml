@model MovizoneApp.Helpers.PaginatedList<MovizoneApp.Models.Movie>
@{
    ViewData["Title"] = "Movies Catalog";
}

<!-- page title -->
<section class="section section--first">
	<div class="container">
		<div class="row">
			<div class="col-12">
				<div class="section__wrap">
					<!-- section title -->
					<h1 class="section__title section__title--head">@Localizer.GetString("Common", "Catalog")</h1>
					<!-- end section title -->

					<!-- breadcrumbs -->
					<ul class="breadcrumbs">
						<li class="breadcrumbs__item"><a asp-controller="Home" asp-action="Index">@Localizer.GetString("Home")</a></li>
						<li class="breadcrumbs__item breadcrumbs__item--active">@Localizer.GetString("Common", "Catalog")</li>
					</ul>
					<!-- end breadcrumbs -->
				</div>
			</div>
		</div>
	</div>
</section>
<!-- end page title -->

<!-- filter -->
<div class="filter">
	<div class="container">
		<div class="row">
			<div class="col-12">
				<form asp-action="Catalog" method="get" class="filter__content">
					<!-- filter items -->
					<div class="filter__items">
						<select class="filter__select" name="genre" id="filter__genre">
							<option value="">@Localizer.GetString("Common", "AllGenres")</option>
							@if (ViewBag.Genres != null)
							{
								foreach (var genre in ViewBag.Genres)
								{
									<option value="@genre" selected="@(ViewBag.SelectedGenre == genre)">@genre</option>
								}
							}
						</select>

						<input type="text" name="search" class="filter__select" placeholder="@Localizer.GetString("Movie", "SearchMovies")" value="@ViewBag.SearchQuery" style="width: 250px;">
					</div>
					<!-- end filter items -->

					<!-- filter btn -->
					<button class="filter__btn" type="submit"><i class="ti ti-search"></i> @Localizer.GetString("Common", "Apply")</button>
					<!-- end filter btn -->

					<!-- amount -->
					<span class="filter__amount">@Localizer.GetString("Movie", "ShowingOf").Replace("{0}", Model.Count.ToString()).Replace("{1}", Model.TotalCount.ToString())</span>
					<!-- end amount -->
				</form>
			</div>
		</div>
	</div>
</div>
<!-- end filter -->

<!-- catalog -->
<div class="section section--catalog">
	<div class="container">
		<div class="row">
			@if (Model != null && Model.Any())
			{
				foreach (var movie in Model)
				{
					var ratingClass = movie.Rating >= 8 ? "item__rate--green" : movie.Rating >= 6 ? "item__rate--yellow" : "item__rate--red";
					<!-- item -->
					<div class="col-6 col-sm-4 col-lg-3 col-xl-2">
						<div class="item">
							<div class="item__cover">
								<img src="@movie.CoverImage" alt="@movie.Title">
								<a asp-action="Details" asp-route-id="@movie.Id" class="item__play">
									<i class="ti ti-player-play-filled"></i>
								</a>
								<span class="item__rate @ratingClass">@movie.Rating</span>
								<button class="item__favorite"
								        type="button"
								        title="@Localizer.GetString("Movie", "AddToWatchlist")"
								        data-id="@movie.Id"
								        data-type="movie"
								        data-title="@movie.Title"
								        data-cover-image="@movie.CoverImage"
								        data-rating="@movie.Rating"
								        data-year="@movie.Year"
								        data-genre="@movie.Genre">
									<i class="ti ti-bookmark"></i>
								</button>
							</div>
							<div class="item__content">
								<h3 class="item__title"><a asp-action="Details" asp-route-id="@movie.Id">@movie.Title</a></h3>
								<span class="item__category">
									<a href="#">@movie.Genre</a>
								</span>
							</div>
						</div>
					</div>
					<!-- end item -->
				}
			}
			else
			{
				<div class="col-12">
					<div class="reviews__empty">
						<i class="ti ti-movie-off"></i>
						<p>@Localizer.GetString("Movie", "NoMoviesFound")</p>
					</div>
				</div>
			}
		</div>

		<!-- Pagination -->
		@if (Model.TotalPages > 1)
		{
			<div class="row">
				<div class="col-12">
					<div class="paginator">
						<ul class="paginator__list">
							@if (Model.HasPreviousPage)
							{
								<li class="paginator__item">
									<a asp-action="Catalog"
									   asp-route-pageNumber="@(Model.PageIndex - 1)"
									   asp-route-search="@ViewBag.SearchQuery"
									   asp-route-genre="@ViewBag.SelectedGenre">
										<i class="ti ti-chevron-left"></i>
									</a>
								</li>
							}

							@for (int i = 1; i <= Model.TotalPages; i++)
							{
								<li class="paginator__item @(Model.PageIndex == i ? "paginator__item--active" : "")">
									<a asp-action="Catalog"
									   asp-route-pageNumber="@i"
									   asp-route-search="@ViewBag.SearchQuery"
									   asp-route-genre="@ViewBag.SelectedGenre">
										@i
									</a>
								</li>
							}

							@if (Model.HasNextPage)
							{
								<li class="paginator__item">
									<a asp-action="Catalog"
									   asp-route-pageNumber="@(Model.PageIndex + 1)"
									   asp-route-search="@ViewBag.SearchQuery"
									   asp-route-genre="@ViewBag.SelectedGenre">
										<i class="ti ti-chevron-right"></i>
									</a>
								</li>
							}
						</ul>
					</div>
				</div>
			</div>
		}
	</div>
</div>
<!-- end catalog -->
